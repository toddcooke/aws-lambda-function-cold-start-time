<html>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.js"
        integrity="sha512-b3xr4frvDIeyC3gqR1/iOi6T+m3pLlQyXNuvn5FiRrrKiMUJK3du2QqZbCywH6JxS5EOfW0DY0M6WwdXFbCBLQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.js"></script>
<canvas id="myChart"></canvas>
<script>
    import {en} from 'date-fns/locale';

    async function script() {

        const python_duration = await fetch('https://raw.githubusercontent.com/toddcooke/aws-lambda-function-cold-start-time/main/data/aws-lambda-function-cold-start-time-dev-python_handler.json')
            .then(response => response.json())
        const node_duration = await fetch('https://raw.githubusercontent.com/toddcooke/aws-lambda-function-cold-start-time/main/data/aws-lambda-function-cold-start-time-dev-node_handler.json')
            .then(response => response.json())
        // const ruby_duration = await fetch('/data/aws-lambda-function-cold-start-time-dev-ruby_handler.json')
        //     .then(response => response.json())
        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(document.getElementById("myChart"), {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        data: python_duration.map(it => {
                            return {
                                x: it.Timestamp,
                                y: it.Average
                            }
                        }),
                        label: "Python",
                        borderColor: "#3e95cd",
                        fill: false
                    },
                    {
                        data: node_duration.map(it => {
                            return {
                                x: it.Timestamp,
                                y: it.Average
                            }
                        }),
                        label: "NodeJS`",
                        borderColor: "#3cba9f",
                        fill: false
                    },
                ]
            },
            options: {
                title: {
                    display: true,
                    text: 'AWS Lambda function cold start time'
                },
                scales: {
                    adapters: {
                        date: {
                            locale: en
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: "Time (Milliseconds)"
                        }
                    },
                    x: {
                        type: 'time',
                        time: {
                            unit: 'day'
                        }
                    }
                }
            }
        });
    }

    script()
</script>
</body>


</html>

